import{a as k}from"./index.esm-B3KFWiaj.js";import{a as P,u as x,r as m,o as C,b as y,c as D,d as S,f as L,B as j,F as E,T as B,A as I,z as b,U as J,V as O}from"./index-DxwKcjF_.js";import{c as F}from"./_commonjsHelpers-C4iS2aBk.js";var T={exports:{}};(function(U,A){(function(d,M){U.exports=M()})(F,function(){function d(e){var n=[];return e.AMapUI&&n.push(M(e.AMapUI)),e.Loca&&n.push(f(e.Loca)),Promise.all(n)}function M(e){return new Promise(function(n,a){var u=[];if(e.plugins)for(var i=0;i<e.plugins.length;i+=1)s.AMapUI.plugins.indexOf(e.plugins[i])==-1&&u.push(e.plugins[i]);if(t.AMapUI===o.failed)a("前次请求 AMapUI 失败");else if(t.AMapUI===o.notload){t.AMapUI=o.loading,s.AMapUI.version=e.version||s.AMapUI.version,i=s.AMapUI.version;var c=document.body||document.head,r=document.createElement("script");r.type="text/javascript",r.src="https://webapi.amap.com/ui/"+i+"/main.js",r.onerror=function(l){t.AMapUI=o.failed,a("请求 AMapUI 失败")},r.onload=function(){if(t.AMapUI=o.loaded,u.length)window.AMapUI.loadUI(u,function(){for(var l=0,v=u.length;l<v;l++){var h=u[l].split("/").slice(-1)[0];window.AMapUI[h]=arguments[l]}for(n();p.AMapUI.length;)p.AMapUI.splice(0,1)[0]()});else for(n();p.AMapUI.length;)p.AMapUI.splice(0,1)[0]()},c.appendChild(r)}else t.AMapUI===o.loaded?e.version&&e.version!==s.AMapUI.version?a("不允许多个版本 AMapUI 混用"):u.length?window.AMapUI.loadUI(u,function(){for(var l=0,v=u.length;l<v;l++){var h=u[l].split("/").slice(-1)[0];window.AMapUI[h]=arguments[l]}n()}):n():e.version&&e.version!==s.AMapUI.version?a("不允许多个版本 AMapUI 混用"):p.AMapUI.push(function(l){l?a(l):u.length?window.AMapUI.loadUI(u,function(){for(var v=0,h=u.length;v<h;v++){var _=u[v].split("/").slice(-1)[0];window.AMapUI[_]=arguments[v]}n()}):n()})})}function f(e){return new Promise(function(n,a){if(t.Loca===o.failed)a("前次请求 Loca 失败");else if(t.Loca===o.notload){t.Loca=o.loading,s.Loca.version=e.version||s.Loca.version;var u=s.Loca.version,i=s.AMap.version.startsWith("2"),c=u.startsWith("2");if(i&&!c||!i&&c)a("JSAPI 与 Loca 版本不对应！！");else{i=s.key,c=document.body||document.head;var r=document.createElement("script");r.type="text/javascript",r.src="https://webapi.amap.com/loca?v="+u+"&key="+i,r.onerror=function(l){t.Loca=o.failed,a("请求 AMapUI 失败")},r.onload=function(){for(t.Loca=o.loaded,n();p.Loca.length;)p.Loca.splice(0,1)[0]()},c.appendChild(r)}}else t.Loca===o.loaded?e.version&&e.version!==s.Loca.version?a("不允许多个版本 Loca 混用"):n():e.version&&e.version!==s.Loca.version?a("不允许多个版本 Loca 混用"):p.Loca.push(function(l){l?a(l):a()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var o;(function(e){e.notload="notload",e.loading="loading",e.loaded="loaded",e.failed="failed"})(o||(o={}));var s={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},t={AMap:o.notload,AMapUI:o.notload,Loca:o.notload},p={AMap:[],AMapUI:[],Loca:[]},g=[],w=function(e){typeof e=="function"&&(t.AMap===o.loaded?e(window.AMap):g.push(e))};return{load:function(e){return new Promise(function(n,a){if(t.AMap==o.failed)a("");else if(t.AMap==o.notload){var u=e.key,i=e.version,c=e.plugins;u?(window.AMap&&location.host!=="lbs.amap.com"&&a("禁止多种API加载方式混用"),s.key=u,s.AMap.version=i||s.AMap.version,s.AMap.plugins=c||s.AMap.plugins,t.AMap=o.loading,i=document.body||document.head,window.___onAPILoaded=function(l){if(delete window.___onAPILoaded,l)t.AMap=o.failed,a(l);else for(t.AMap=o.loaded,d(e).then(function(){n(window.AMap)}).catch(a);g.length;)g.splice(0,1)[0]()},c=document.createElement("script"),c.type="text/javascript",c.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+s.AMap.version+"&key="+u+"&plugin="+s.AMap.plugins.join(","),c.onerror=function(l){t.AMap=o.failed,a(l)},i.appendChild(c)):a("请填写key")}else if(t.AMap==o.loaded)if(e.key&&e.key!==s.key)a("多个不一致的 key");else if(e.version&&e.version!==s.AMap.version)a("不允许多个版本 JSAPI 混用");else{if(u=[],e.plugins)for(i=0;i<e.plugins.length;i+=1)s.AMap.plugins.indexOf(e.plugins[i])==-1&&u.push(e.plugins[i]);u.length?window.AMap.plugin(u,function(){d(e).then(function(){n(window.AMap)}).catch(a)}):d(e).then(function(){n(window.AMap)}).catch(a)}else if(e.key&&e.key!==s.key)a("多个不一致的 key");else if(e.version&&e.version!==s.AMap.version)a("不允许多个版本 JSAPI 混用");else{var r=[];if(e.plugins)for(i=0;i<e.plugins.length;i+=1)s.AMap.plugins.indexOf(e.plugins[i])==-1&&r.push(e.plugins[i]);w(function(){r.length?window.AMap.plugin(r,function(){d(e).then(function(){n(window.AMap)}).catch(a)}):d(e).then(function(){n(window.AMap)}).catch(a)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,s={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},t={AMap:o.notload,AMapUI:o.notload,Loca:o.notload},p={AMap:[],AMapUI:[],Loca:[]}}}})})(T);const q={__name:"InsertAddressView",setup(U){const A=P();x();const d=m({}),M=m(["请选择","请选择","请选择"]),f=m({}),o=()=>{p({user_id:A.userId,address_id:d.value.address_id})},s=e=>{console.log(d.value!=null),d.value!=null?(console.log("修改"),g({address_id:d.value.address_id,user_id:A.userId,user_name:e.name,address:e.province+e.city+e.county+e.addressDetail,phonenum:e.tel})):w({user_id:A.userId,user_name:e.name,address:e.province+e.city+e.county+e.addressDetail,phonenum:e.tel})},t=()=>{history.back(),A.clearAddressInfo()},p=async e=>{const n=await B(e);n.success==1?(I("删除成功"),history.back()):b("删除失败"),console.log(n)},g=async e=>{const n=await J(e);n.success==1?(I("修改成功"),A.clearAddressInfo(),history.back()):b("修改失败"),console.log(n)},w=async e=>{const n=await O(e);n.success==1?(I("添加成功"),history.back()):b("添加失败"),console.log(n)};return C(()=>{if(d.value=A.addressInfo,console.log(d.value),d.value!=null){var e=/.+?(省|市|自治区|自治州|县|区)/g;console.log(d.value.address.match(e));let n=d.value.address.match(e);console.log(n[n.length-1].length),f.value.name=d.value.name,f.value.tel=d.value.tel,f.value.province=n[0],f.value.city=n[1],f.value.county=n[2],f.value.addressDetail=d.value.address.substr(d.value.address.lastIndexOf(n[n.length-1])+n[n.length-1].length),console.log(f.value)}}),(e,n)=>{const a=y("van-nav-bar"),u=y("van-address-edit");return D(),S(E,null,[L(a,{title:"编辑地址","left-text":"返回","left-arrow":"",onClickLeft:t}),L(u,{"area-list":j(k),"show-delete":"","show-set-default":"","show-search-result":"","search-result":e.searchResult,"area-columns-placeholder":M.value,onSave:s,onDelete:o,onChangeDetail:e.onChangeDetail,"address-info":f.value},null,8,["area-list","search-result","area-columns-placeholder","onChangeDetail","address-info"])],64)}}};export{q as default};
